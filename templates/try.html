{% extends 'admin/index.html' %}
{% block script %}  
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>


{% endblock  %}
{% block css %}<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

<style>@import url('https://fonts.googleapis.com/css?family=Assistant');

    body {
        background: #eee;
        font-family: Assistant, sans-serif
    }
    
    .cell-1 {
      border-collapse: separate;
      border-spacing: 0 4em;
      background: #ffffff;
      border-bottom: 5px solid transparent;
      background-color: gold;
      background-clip: padding-box;
      cursor: pointer;
    }
    
    thead {
      background: #ffffff;
    }
    
    
    .table-elipse {
      cursor: pointer;
    }
    
    #demo {
      -webkit-transition: all 0.3s ease-in-out;
      -moz-transition: all 0.3s ease-in-out;
      -o-transition: all 0.3s 0.1s ease-in-out;
      transition: all 0.3s ease-in-out;
    }
    
    .row-child {
      background-color: #000;
      color: #fff;
    }</style>

{% endblock  %}
{% block content %}
<div class="container">
    <div class="d-flex justify-content-center row">
        <div class="col-md-10">
            <div class="rounded">
                <div class="table-responsive table-borderless">
                  {% if ords %}
                    <table class="table">
                        <thead>
                            <tr>
                                <th class="text-center">S. No.</th>
                                <th>Order #</th>
                                <th>Customer</th>
                                <th>status</th>
                                <th>Total</th>
                                <th>Created</th>
                                <th>Update</th>
                            </tr>
                        </thead>
                        <tbody class="table-body">
                            {% for ord in ords %}
                            <tr class="cell-1" data-toggle="collapse" data-target="#{{ord.id}}" style="border-top: #000; background-color: rgba(169, 169, 169, 0.442);">
                                <td class="text-center">1</td>
                                <td>{{ord.id}}</td>
                                <td>{{ord.user.name}}</td>
                                {% if ord.status == 'C' %}
                                <td><span class="badge badge-danger">{{ord.get_status_display}}</span></td>
                                {% elif ord.status == 'P' %}
                                <td><span class="badge badge-primary">{{ord.get_status_display}}</span></td>
                                {% elif ord.status == 'S' %}
                                <td><span class="badge badge-warning">{{ord.get_status_display}}</span></td>
                                {% else %}
                                <td><span class="badge badge-success">{{ord.get_status_display}}</span></td>
                                {% endif %}
                                <td>â‚¹{{ord.total_price}}</td>
                                <td>{{ord.created_at}}</td>
                                <td>
                                    <div class="container text-center" >
                                        <!-- Button trigger modal -->
                                        <button type="button" class="btn btn-primary btn-sm" data-toggle="modal" data-target="#modal{{ ord.id }}">
                                          update
                                      </button>
                                      </div>
                                        
                                      <!-- Modal -->
                                      <div class="modal fade" id="modal{{ ord.id }}">
                                        <div class="modal-dialog" role="document">
                                          <div class="modal-content">
                                            <div class="modal-header">
                                              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                <span aria-hidden="true">&times;</span>
                                              </button>
                                              <h4 class="modal-title">Update Order status {{ord.id}}</h4>
                                            </div>
                                            <div class="modal-body">
                                      
                                                <div class="control-group">
                                                    <form action="{% url 'update_order_status' id=ord.id %}" method="post">
                                                        {% csrf_token %}
                                                  <label for="select2-multiple" class="control-label">Select</label>
                                                  <select id="select2-multiple" class="form-control select2-single"  name="status">
                                                    <option value="{{ ord.status }}">{{ord.get_status_display}}</option>
                                                      <option value="S">Shipped</option>
                                                      <option value="D">Delivered</option>
                                                      <option value="C">Cancel</option>
                                                  </select>
                                                </div>
                                            </div>
                                            <div class="modal-footer">
                                              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                              <button type="submit" class="btn btn-primary">Save changes</button></form>
                                            </div>
                                          </div><!-- /.modal-content -->
                                        </div><!-- /.modal-dialog -->
                                      </div><!-- /.modal -->
                                      

                                </td>
                                <td class="table-elipse" data-toggle="collapse" data-target="#demo"><i class="fa fa-ellipsis-h text-white-50"></i></td>
                            </tr>
                            
                            <div id="{{ord.id}}" class="collapse cell-1 " >
                                <tr style=" background-color: rgba(169, 169, 169, 0.145);">
                                {% comment %} <td colspan="0.5"></td>
                                <td colspan="0.5">Items</td>
                                <td colspan="0.5">Color</td>
                                <td colspan="0.5">Quantity</td>
                                <td colspan="0.5">Total</td> {% endcomment %}
                                </tr>
                                {% for item in ord.items.all %}
                                <tr >
                                <td class="" colspan="0.5"><i class=""></i></td>
                                <td colspan="0.5">{{item.product.product.name}}</td>
                                <td colspan="0.5">{{item.product.color}}</td>
                                <td colspan="0.5">{{item.quantity}}</td>
                                <td colspan="0.5">{{item.total_itemprice}}</td></tr>
                                {% endfor %}
                               
                                <br>
                                </div>
                       
                            {% endfor %}
                           
                        </tbody>
                    </table>{% else %}
                    No orders


                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock  %}